"{{ Vite::asset('resources/assets/images/Dorado Impex Logo TM Mark.png') }}"


@extends('frontend.layouts.navbarlayout')


@section('title','Blog')

@section('main')

   

@endsection


<li><a href="/applications/automotive">Automotive</a></li>
<li><a href="/applications/aerospace">Aerospace</a></li>
<li><a href="/applications/dental-industry">Dental Industry</a></li>
<li><a href="/applications/jewelry-industry">Jewelry Industry</a></li>
<li><a href="/applications/industrial-engineering">Industrial Engineering</a></li>
<li class="active"><a href="3d-printing-consumables">3D Printing Consumables</a></li>
<li><a href="/applications/additive-manufacturing">Additive Manufacturing</a></li>
<li><a href="/applications/educational-applications">Educational Applications</a></li>


 <script>
        // Enhanced AuthManager with better debugging
        class AuthManager {
            constructor() {
                this.tokenKey = 'auth_token';
                this.userKey = 'user_data';
                this.expiryKey = 'token_expiry';
                this.init();
            }

            init() {
                console.log('AuthManager initialized');
                this.checkAuthStatus();
                this.setupLogoutHandler();
                this.startTokenChecker();
            }

            // Store auth data in localStorage
            storeAuthData(token, user, expiresIn) {
                const expiryTime = Date.now() + (expiresIn * 1000);
                
                localStorage.setItem(this.tokenKey, token);
                localStorage.setItem(this.userKey, JSON.stringify(user));
                localStorage.setItem(this.expiryKey, expiryTime.toString());
                
                console.log('‚úÖ Auth data stored in localStorage:', {
                    token: token ? 'Yes' : 'No',
                    user: user ? user.name : 'No',
                    role: user ? user.role : 'No',
                    expiresIn: expiresIn
                });
                
                this.updateUI();
            }

            // Get stored token
            getToken() {
                return localStorage.getItem(this.tokenKey);
            }

            // Get stored user data
            getUser() {
                try {
                    const userData = localStorage.getItem(this.userKey);
                    const user = userData ? JSON.parse(userData) : null;
                    console.log('üìã Retrieved user from localStorage:', user);
                    return user;
                } catch (e) {
                    console.error('‚ùå Error parsing user data:', e);
                    return null;
                }
            }

            // Check if token is valid
            isTokenValid() {
                const token = this.getToken();
                const expiry = localStorage.getItem(this.expiryKey);
                
                console.log('üîç Token validation check:', {
                    hasToken: !!token,
                    hasExpiry: !!expiry,
                    expiryTime: expiry ? new Date(parseInt(expiry)).toISOString() : 'None'
                });
                
                if (!token || !expiry) {
                    console.log('‚ùå No token or expiry found');
                    return false;
                }
                
                const isValid = Date.now() < parseInt(expiry);
                console.log('üîê Token valid:', isValid, 'Time left:', this.formatTimeRemaining());
                return isValid;
            }

            // Check auth status and update UI
            async checkAuthStatus() {
                console.log('üîÑ Checking auth status...');
                
                if (this.isTokenValid()) {
                    console.log('‚úÖ User is logged in');
                    this.updateUI();
                } else {
                    console.log('‚ùå User is not logged in');
                    this.clearAuthData();
                    this.showLoginRegister();
                }
            }

            // Update UI based on auth status
            updateUI() {
                const user = this.getUser();
                const registerItem = document.getElementById('register-item');
                const loginItem = document.getElementById('login-item');
                const userInfoItem = document.getElementById('user-info-item');
                const logoutItem = document.getElementById('logout-item');
                const userName = document.getElementById('user-name');

                console.log('üé® Updating UI, user data:', user);

                if (user && this.isTokenValid()) {
                    // User is logged in
                    if (registerItem) registerItem.classList.add('d-none');
                    if (loginItem) loginItem.classList.add('d-none');
                    if (userInfoItem) userInfoItem.classList.remove('d-none');
                    if (logoutItem) logoutItem.classList.remove('d-none');
                    if (userName) userName.textContent = user.name;
                    
                    console.log('‚úÖ UI updated: Showing user menu for', user.name);
                } else {
                    // User is not logged in
                    console.log('üîÑ UI updated: Showing login/register');
                    this.showLoginRegister();
                }
            }

            // Show login/register links
            showLoginRegister() {
                const registerItem = document.getElementById('register-item');
                const loginItem = document.getElementById('login-item');
                const userInfoItem = document.getElementById('user-info-item');
                const logoutItem = document.getElementById('logout-item');

                if (registerItem) registerItem.classList.remove('d-none');
                if (loginItem) loginItem.classList.remove('d-none');
                if (userInfoItem) userInfoItem.classList.add('d-none');
                if (logoutItem) logoutItem.classList.add('d-none');
                
                console.log('üë§ Showing login/register links');
            }

            // Clear auth data from localStorage
            clearAuthData() {
                localStorage.removeItem(this.tokenKey);
                localStorage.removeItem(this.userKey);
                localStorage.removeItem(this.expiryKey);
                console.log('üóëÔ∏è Auth data cleared from localStorage');
                this.updateUI();
            }

            // Setup logout handler
            setupLogoutHandler() {
                document.addEventListener('click', (e) => {
                    if (e.target.id === 'logout-btn' || e.target.closest('#logout-btn')) {
                        e.preventDefault();
                        this.logout();
                    }
                });
            }

            // Logout function
            async logout() {
                try {
                    const token = this.getToken();
                    
                    if (token) {
                        await fetch('/logout', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${token}`,
                                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content
                            },
                            body: JSON.stringify({ force_logout: true })
                        });
                    }
                } catch (error) {
                    console.error('Logout API error:', error);
                } finally {
                    this.clearAuthData();
                    alert('You have been logged out successfully!');
                    window.location.href = '/';
                }
            }

            // Start periodic token checker
            startTokenChecker() {
                setInterval(() => {
                    this.checkAuthStatus();
                }, 30000);
            }

            // Format time remaining
            formatTimeRemaining() {
                const expiry = localStorage.getItem(this.expiryKey);
                if (!expiry) return 'No token';
                
                const timeLeft = parseInt(expiry) - Date.now();
                if (timeLeft <= 0) return 'Expired';
                
                const minutes = Math.floor(timeLeft / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                return `${minutes}m ${seconds}s`;
            }
        }

        // Initialize auth manager when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ DOM loaded, initializing AuthManager...');
            window.authManager = new AuthManager();
            
            // Check if already logged in and redirect from auth pages
            const token = localStorage.getItem('auth_token');
            const userData = localStorage.getItem('user_data');
            const expiry = localStorage.getItem('token_expiry');
            
            if (token && userData && expiry && Date.now() < parseInt(expiry)) {
                const currentPath = window.location.pathname;
                console.log('üìç Current path:', currentPath);
                
                // Redirect if trying to access login/register while logged in
                if (currentPath === '/signin' || currentPath === '/signup') {
                    console.log('üîÑ Redirecting to home from auth page');
                    window.location.href = '/';
                }
            }
        });

        // Global login success handler
        async function handleLoginSuccess(responseData) {
            console.log('üéâ Global login success handler called:', responseData);
            
            if (responseData.token && responseData.user) {
                console.log('üì¶ Storing auth data:', {
                    token: responseData.token ? 'Yes' : 'No',
                    user: responseData.user ? responseData.user.name : 'No',
                    role: responseData.user ? responseData.user.role : 'No',
                    expiresIn: responseData.expires_in
                });
                
                // Store auth data
                if (window.authManager) {
                    window.authManager.storeAuthData(
                        responseData.token,
                        responseData.user,
                        responseData.expires_in || 300
                    );
                } else {
                    // Fallback storage
                    localStorage.setItem('auth_token', responseData.token);
                    localStorage.setItem('user_data', JSON.stringify(responseData.user));
                    localStorage.setItem('token_expiry', (Date.now() + (responseData.expires_in || 300) * 1000).toString());
                }
                
                // Show welcome message
                alert('Welcome back, ' + responseData.user.name + '!');
                
                // Redirect after short delay
                setTimeout(() => {
                    console.log('üîÑ Redirecting to:', responseData.redirect || '/');
                    window.location.href = responseData.redirect || '/';
                }, 500);
            } else {
                console.error('‚ùå Invalid response data:', responseData);
            }
        }

        // Global register success handler  
        async function handleRegisterSuccess(responseData) {
            console.log('üéâ Global register success handler called:', responseData);
            
            if (responseData.token && responseData.user) {
                if (window.authManager) {
                    window.authManager.storeAuthData(
                        responseData.token,
                        responseData.user,
                        responseData.expires_in || 300
                    );
                }
                
                alert('Welcome to DoradoImpex, ' + responseData.user.name + '!');
                
                setTimeout(() => {
                    window.location.href = responseData.redirect || '/';
                }, 500);
            }
        }

        // Auto-logout when token expires
        function startAutoLogoutTimer() {
            const expiry = localStorage.getItem('token_expiry');
            if (!expiry) return;

            const timeUntilExpiry = parseInt(expiry) - Date.now();
            
            if (timeUntilExpiry > 0) {
                console.log('‚è∞ Auto-logout timer set for:', timeUntilExpiry + 1000, 'ms');
                setTimeout(async () => {
                    console.log('üîî Auto-logout timer triggered');
                    if (window.authManager) {
                        await window.authManager.checkAuthStatus();
                    }
                }, timeUntilExpiry + 1000);
            }
        }

        // Start auto-logout timer
        document.addEventListener('DOMContentLoaded', startAutoLogoutTimer);
    </script>



 <script>
document.getElementById('login-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    
    submitBtn.innerHTML = 'Signing in...';
    submitBtn.disabled = true;
    
    console.log('üì§ Sending login request...');
    
    try {
        const response = await fetch('{{ route("login.submit") }}', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'Accept': 'application/json',
                'X-CSRF-TOKEN': '{{ csrf_token() }}'
            },
            body: formData
        });
        
        const data = await response.json();
        
        console.log('üì• Login response:', data);
        
        if (data.success) {
            console.log('‚úÖ Login successful, calling handleLoginSuccess');
            
            // Use the global function to handle success
            if (typeof handleLoginSuccess === 'function') {
                handleLoginSuccess(data);
            } else {
                console.log('‚ö†Ô∏è handleLoginSuccess not found, using fallback');
                // Fallback: store directly and redirect
                localStorage.setItem('auth_token', data.token);
                localStorage.setItem('user_data', JSON.stringify(data.user));
                localStorage.setItem('token_expiry', (data.expires_at * 1000).toString());
                
                alert('Login successful! Welcome back, ' + data.user.name);
                window.location.href = data.redirect || '/';
            }
            
        } else {
            console.log('‚ùå Login failed:', data.message);
            alert(data.message || 'Login failed. Please check your credentials.');
        }
    } catch (error) {
        console.error('üí• Login error:', error);
        alert('An error occurred during login. Please try again.');
    } finally {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
    }
});
 </script>




<script>
document.getElementById('register-Form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    
    submitBtn.innerHTML = 'Creating Account...';
    submitBtn.disabled = true;
    
    try {
        const response = await fetch('{{ route("register.submit") }}', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'Accept': 'application/json',
                'X-CSRF-TOKEN': '{{ csrf_token() }}'
            },
            body: formData
        });
        
        const data = await response.json();
        
        if (data.success) {
            // Use the global function to handle success
            if (typeof handleRegisterSuccess === 'function') {
                handleRegisterSuccess(data);
            } else {
                // Fallback: store directly and redirect
                localStorage.setItem('auth_token', data.token);
                localStorage.setItem('user_data', JSON.stringify(data.user));
                localStorage.setItem('token_expiry', (data.expires_at * 1000).toString());
                window.location.href = data.redirect || '/';
            }
            
            // Show success message
            alert('Registration successful! Welcome, ' + data.user.name);
            
        } else {
            // Show validation errors
            if (data.errors) {
                let errorMessage = '';
                for (const field in data.errors) {
                    errorMessage += data.errors[field].join('\n') + '\n';
                }
                alert(errorMessage.trim());
            } else {
                alert(data.message || 'Registration failed');
            }
        }
    } catch (error) {
        console.error('Error:', error);
        alert('An error occurred during registration. Please try again.');
    } finally {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
    }
});
</script>







@extends('frontend.layouts.navbarlayout')

@section('title', $category->name)

@section('main')
    <!-- ================ Page Heading Start ================ -->
    <div class="page-heading">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="content">
                        <h1>{{ $category->name }}</h1>
                        <p class="lead">Professional 3D printing solutions for every need</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ================ Page Heading End ================ -->

    <!-- ================ Page Content Start ================ -->
    <div class="page-content sec-padding sec-heading">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <!-- DYNAMIC 3D PRINTER PRODUCTS -->
                    <div class="printer-products">
                        <h2 class="mb-4">Our {{ $category->name }} Collection</h2>
                        
                        @if($products->count() > 0)
                        <div class="row g-4">
                            @foreach($products as $product)
                            <div class="col-lg-6">
                                <div class="printer-product-card shadow py-3 rounded-4 h-100">
                                    <div class="product-img-wrapper p-4 text-center">
                                        @if($product->image)
                                            <img src="{{ Storage::url($product->image) }}" 
                                                 alt="{{ $product->title }}" 
                                                 class="rounded-3 img-fluid" 
                                                 style="max-height: 200px; object-fit: contain;">
                                        @else
                                            <img src="{{ Vite::asset('resources/assets/images/default-product.png') }}" 
                                                 alt="Default Product" 
                                                 class="rounded-3 img-fluid"
                                                 style="max-height: 200px; object-fit: contain;">
                                        @endif
                                    </div>
                                    <div class="product-heading px-4">
                                        <h5 class="text-center">{{ $product->title }}</h5>
                                    </div>
                                    <div class="product-description px-4 mt-3">
                                        <p class="text-center">
                                            {{ Str::limit(strip_tags($product->description), 150) }}
                                        </p>
                                    </div>
                                    <div class="product-actions px-4 mt-3 text-center">
                                        <a href="{{ route('products.show', $product->slug) }}" class="btn btn-primary">
                                            <i class="fa-solid fa-eye me-2"></i>View Details
                                        </a>
                                    </div>
                                </div>
                            </div>
                            @endforeach
                        </div>
                        @else
                        <div class="alert alert-info text-center mt-5">
                            <h4>No {{ $category->name }} Products Available</h4>
                            <p>We're currently updating our {{ strtolower($category->name) }} collection. Please check back soon!</p>
                        </div>
                        @endif
                    </div>

                    <!-- Your existing static content remains the same -->
                    <div class="desc-1 mt-5">
                        <h2>Why Choose Our 3D Printers?</h2>
                        <ul>
                            <li>Pre-configured settings optimize print quality without additional user adjustments</li>
                            <li>Fast heat-up in just 15 minutes with adjustable temperatures up to 50¬∞C</li>
                            <li>Designed for continuous 24/7 printing with robust build plates</li>
                            <li>Auto-cooling safety features for worry-free operation</li>
                            <li>Easy modular part replacement and technical support</li>
                        </ul>
                    </div>

                    <!-- Continue with your existing service features -->
                </div>

                <div class="col-lg-4 ps-lg-3">
                    <div class="app-right-sec">
                        <div class="sec-heading">
                            <h3>Product Categories</h3>
                            <hr>
                        </div>
                        <div class="app-pages-link-wrapper">
                            <ul class="list-unstyled">
                                <li class="active">
                                    <!-- Use simple URL instead of named route -->
                                    <a href="/products/3d-printer" class="fw-bold text-primary">
                                        <i class="fa-solid fa-print me-2"></i>3D Printer
                                    </a>
                                </li>
                                <li>
                                    <!-- Use simple URL instead of named route -->
                                    <a href="/products/3d-printer-software">
                                        <i class="fa-solid fa-computer me-2"></i>3D Printer Software
                                    </a>
                                </li>
                                <li>
                                    <!-- Use simple URL instead of named route -->
                                    <a href="/products/3d-printing-resin">
                                        <i class="fa-solid fa-flask me-2"></i>3D Printing Resin
                                    </a>
                                </li>
                                <li>
                                    <!-- Use simple URL instead of named route -->
                                    <a href="/products/3d-printing-service">
                                        <i class="fa-solid fa-gears me-2"></i>3D Printing Service
                                    </a>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Your existing CTA and other sidebar content -->
                        <div class="app-cta rounded-3 mt-4">
                            <div class="cta-sub-heading">Special Offer</div>
                            <h4 class="mt-2 mb-3">Save More as You Buy More ‚Äì Up to 50% Off!</h4>
                            <div>
                                <a href="/contact" class="button-3 py-2">Get a Quote Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
@endsection